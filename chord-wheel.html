<!DOCTYPE html>
<meta charset="utf-8">
<style>

body {
  font: 10px sans-serif;
}

.chord path {
  fill-opacity: .67;
}

</style>
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script>

var matrix = [
[3001,6545,2188818,565180,604481,227479,239833,23996,670389,1063364,163523,8596,45960,10933,6686,18522,67138,7400,8434,2911,1650,2938,732,649,831,554,1342,1029,837,517,9653,2050,180,545,1895,28271,0,0,0,0,0,0,0,32708,29241,7153,8878,511,0,35143,5172,81596],
[408,609,505566,111576,77802,21241,19429,1931,47374,84478,10799,522,3069,605,412,1140,4070,386,688,270,131,231,63,51,67,60,73,66,66,55,619,109,15,43,163,1585,0,0,0,0,0,0,0,2518,1799,429,739,41,0,2769,257,4744],
[2008109,559471,5834,492505,465681,106703,82062,9598,197210,275211,42457,3085,13956,3647,2009,4717,18265,2035,2856,1390,1058,1150,363,311,461,361,585,754,574,422,5309,1378,146,309,1005,6772,0,0,0,0,0,0,0,16793,9452,2205,5903,397,0,12547,1114,28590],
[543375,113988,488687,987,441471,99245,58599,6908,119569,128215,25902,1892,7331,1837,1009,2584,9118,1032,1608,1085,880,1082,416,382,632,427,423,524,571,368,4072,1006,105,300,613,3835,0,0,0,0,0,0,0,11348,4564,1168,5764,358,0,7562,508,17366],
[566419,76942,451766,437048,1664,344911,136283,10328,181053,175728,29079,1712,6776,1831,898,1783,6866,785,1675,789,717,1051,303,291,520,394,459,477,370,215,2437,850,108,226,434,3008,0,0,0,0,0,0,0,26473,4550,909,4276,245,0,11054,886,42519],
[242006,24762,111480,113832,391147,330,101005,7770,101866,99189,17059,1021,3378,932,512,744,3026,329,784,371,320,430,161,123,231,181,167,175,254,128,1190,451,42,121,183,1445,0,0,0,0,0,0,0,20566,2334,514,2133,149,0,8823,908,27580],
[213983,19570,76926,58688,135245,95149,226,20340,226061,193866,40535,2202,8690,1953,1142,1814,7793,884,1685,742,542,647,248,199,554,327,365,505,376,198,2013,709,81,199,351,2591,0,0,0,0,0,0,0,33827,4764,1054,4027,190,0,18425,672,25206],
[24217,2031,9458,6609,10176,7201,18848,57,99941,142118,39847,1908,4075,1323,580,535,1389,170,470,350,144,176,88,56,88,67,85,123,82,23,413,147,21,65,87,737,0,0,0,0,0,0,0,17196,10157,347,872,107,0,77417,10610,50603],
[596007,45635,171242,112601,163693,95464,200188,94778,1472,651034,762961,35067,74489,14161,8556,9409,21720,2204,5877,2928,2467,3267,960,870,1519,1307,1472,1517,1061,626,7483,2437,309,719,1408,10201,0,0,0,0,0,0,0,223766,168860,4236,16184,792,0,11059,12168,46812],
[1148423,94569,284859,146030,182339,109656,200990,130286,519498,2165,4300977,170700,479748,94446,57625,71662,176176,19872,52745,25693,25614,28425,10108,9060,14376,12974,14516,14318,9867,6223,72181,25446,2732,7700,13284,138827,0,0,0,0,0,0,0,168213,1689367,32061,141925,8024,0,3528,7029,19505],
[142128,9631,39392,24892,27052,14459,36991,39245,690853,4475259,911,8052,36096,8159,4665,4906,11603,1278,5418,1569,1665,1816,699,626,946,663,853,790,610,337,4111,1552,155,350,713,5768,0,0,0,0,0,0,0,35582,294589,2250,9522,348,0,5098,8356,85853],
[7199,528,2664,1952,1731,1051,2529,2288,36185,180607,3271,393,118029,49678,38133,23593,52441,5901,19934,6220,5977,6705,2759,2254,3401,2706,2677,2899,2256,1395,16985,5806,606,1348,2525,22525,0,0,0,0,0,0,0,1881,244659,11468,36759,1455,0,397,701,7109],
[41984,3052,13355,7438,6538,3230,8060,4366,71629,482784,27742,138093,224,10916,40319,30368,56483,7882,22558,10122,6935,8067,3418,3050,5207,4470,4324,4529,3794,2159,21615,7549,1001,2198,3401,31209,0,0,0,0,0,0,0,5590,33573,11630,49255,2567,0,1089,3286,26791],
[10956,622,3759,1968,1906,938,2006,1257,14352,96331,6707,53558,12237,744,11748,21983,40118,5443,19326,6203,4245,5214,1958,1816,3809,3069,3326,3070,2308,1312,13455,4889,602,1710,2196,23960,0,0,0,0,0,0,0,1219,8537,6918,30071,2019,0,418,979,11817],
[6081,414,2114,1096,891,440,1043,912,9087,62159,3657,43462,51825,17450,89,17655,32654,3302,13914,2680,2436,3120,1036,894,1983,1527,1789,1396,1293,683,6004,2426,402,753,818,7100,0,0,0,0,0,0,0,885,3896,9617,15707,820,0,175,459,8042],
[18153,1228,4837,2791,1799,796,1777,772,8485,70690,4059,25043,32908,21771,18187,152,68717,19622,58947,14231,10380,19002,4538,4101,6295,3781,4052,3580,2624,1313,12095,5074,657,1457,1814,17802,0,0,0,0,0,0,0,1374,2509,5133,62164,2123,0,261,977,22263],
[67332,4440,18263,9855,6978,3090,7191,1935,18673,174845,8726,57659,60882,37028,34970,91179,313,30618,124742,41063,35447,72961,12828,11575,15134,9143,8786,7750,5062,2715,28479,10431,1266,2632,3567,33370,0,0,0,0,0,0,0,4002,5577,24218,199609,4012,0,867,4473,89620],
[6553,421,2025,904,677,323,722,177,1818,16423,878,5482,7433,4518,2990,18574,31973,200,120004,57333,44413,102821,21326,17622,20276,9432,10320,7896,4936,2324,28147,10454,976,1865,2878,22544,0,0,0,0,0,0,0,448,599,3528,301958,2385,0,99,526,10512],
[8753,849,2942,1751,1686,822,1621,656,5097,51939,4500,22319,24549,19939,14383,60060,130078,126172,257,82353,121534,177766,56307,51092,66857,40093,24310,21635,13491,7211,58190,19107,2585,4902,5426,39866,0,0,0,0,0,0,0,961,2732,9425,737182,5893,0,200,700,17422],
[3124,245,1605,1201,923,398,834,427,2842,28155,1226,7669,12115,6136,3325,16329,48195,66861,119183,203,74721,92255,33770,26369,28681,15138,10799,8238,5359,2533,19581,9142,1462,2283,1976,17886,0,0,0,0,0,0,0,590,671,2419,415648,2736,0,176,600,20870],
[1570,142,1138,1016,842,421,677,229,2365,28166,1414,8328,9249,4635,3064,13311,42607,54471,136062,87139,225,127406,213237,258428,153944,46099,24411,18400,8667,4819,42973,16836,1699,2646,5381,38115,0,0,0,0,0,0,0,573,762,1676,26197,3562,0,130,395,24524],
[4152,329,1769,1358,1218,543,791,240,2887,30473,1378,8131,10064,4924,3476,18339,71706,96606,174945,88986,109545,239,75639,177449,310261,151100,117684,81228,44665,25299,215490,87607,9946,18630,28399,237619,0,0,0,0,0,0,0,688,904,1764,49988,24446,0,152,499,23127],
[721,71,392,378,288,126,263,108,802,10022,557,2871,3771,1845,1187,4952,12860,20886,51745,34560,241857,67827,114,28026,155139,37685,16631,11785,5766,2997,29476,9878,972,1764,3449,21051,0,0,0,0,0,0,0,184,273,640,138957,2259,0,48,132,8665],
[709,46,387,471,362,138,267,88,885,10446,526,2914,3797,1987,1112,5012,13439,19739,55403,30410,331288,221939,44343,198,45321,47778,21567,16030,8218,3763,36075,15252,1095,2267,3384,23106,0,0,0,0,0,0,0,239,282,642,135614,2838,0,32,153,8340],
[861,65,581,705,548,263,502,138,1387,15500,736,4327,6342,3759,2339,6987,17612,22464,68719,32646,183580,292159,168168,43116,431,105101,129133,103949,64767,36750,415504,112366,9487,19868,37933,338057,0,0,0,0,0,0,0,338,475,955,70371,24758,0,130,294,13244],
[503,41,377,404,379,151,297,104,1086,12847,471,3061,5076,2756,1670,3802,9600,9316,38822,16110,50513,145535,42710,49512,114113,132,46022,39717,24372,13490,73594,32763,3468,6080,7372,54078,0,0,0,0,0,0,0,308,279,748,24902,7929,0,104,238,9562],
[1342,87,658,511,507,165,387,149,1223,13679,614,3598,4924,3016,1806,4160,8604,10550,23562,10899,26930,109371,19212,26511,133840,45965,304,10180,57838,34771,257351,82206,8011,11790,12893,85609,0,0,0,0,0,0,0,296,392,663,16860,12171,0,82,287,11231],
[1024,75,802,545,470,234,472,159,1244,13866,501,3116,5089,2794,1556,3635,7916,7717,20773,8781,19788,75532,13442,17772,107103,39095,12903,220,80791,61215,549992,138393,11823,17641,18658,115040,0,0,0,0,0,0,0,373,300,518,11818,17117,0,85,352,15279],
[808,74,548,558,356,247,345,100,870,9297,358,2450,3903,1943,1283,2763,5096,4902,12281,5634,10266,39476,6591,8543,65277,24414,62798,83007,190,18591,488851,155182,9304,11716,7164,40005,0,0,0,0,0,0,0,218,180,297,6672,15957,0,48,264,10012],
[573,44,414,329,233,113,193,37,512,6305,199,1676,2377,1178,659,1436,2747,2399,7124,2804,5683,23619,3854,4393,38411,13878,37542,59365,18710,356,2437505,449461,23468,25735,19769,86909,0,0,0,0,0,0,0,178,135,169,3669,26391,0,38,138,6568],
[9219,569,5194,3928,2477,1097,1885,595,5872,68093,2662,18030,23384,11212,6261,12676,28632,27113,55853,21430,50013,188075,33954,38156,412476,73278,264521,539955,461129,2342613,647,242722,28062,29706,32643,146729,0,0,0,0,0,0,0,1648,1238,1489,37087,31026,0,390,1716,76850],
[2440,148,1585,1055,861,496,741,220,2143,26106,1160,6602,8604,4575,2701,5319,10888,10325,19664,9986,20222,84098,11993,16307,122625,33732,86346,140994,142342,433882,253348,887,115010,140895,129344,615615,0,0,0,0,0,0,0,559,626,649,14077,117012,0,132,559,27097],
[195,6,135,95,111,59,80,25,224,2531,133,620,993,552,399,664,1135,876,2505,1421,1823,8642,1271,1136,9446,3225,7583,11482,8769,22457,28642,106623,457,241510,240363,1151036,0,0,0,0,0,0,0,99,63,78,1163,295749,0,21,62,2247],
[601,46,313,288,241,119,179,65,548,7230,232,1384,2444,1511,705,1470,2583,1741,4498,2386,3225,15977,2089,2539,18824,5893,11983,17306,11356,25408,30818,138568,270786,478,123854,561122,0,0,0,0,0,0,0,187,165,223,2155,45900,0,35,123,7461],
[1812,151,936,573,418,197,293,123,1007,12734,403,2592,3524,1927,864,1863,3515,2524,5249,2323,6412,24350,3963,3789,41122,7185,13307,17835,7024,18818,32383,121376,225580,115602,927,2837528,0,0,0,0,0,0,0,271,228,228,3315,98654,0,52,283,14162],
[27444,1565,6581,3832,3035,1611,2566,1194,8127,119973,3682,23341,32617,20418,7191,17300,32656,20375,40187,19943,43522,205333,26107,27072,334786,50284,84437,114472,39377,88712,154250,602106,1147438,563397,2660330,3283,0,0,0,0,0,0,0,2702,2250,2045,23063,616333,0,813,2340,164480],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2159,2055952,1616657,310833,641899,96038,1641810,0,0,0,0,0,458778,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2110654,420,53201,58867,92863,8767,79885,0,0,0,0,0,68273,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1582104,67044,460,44277,120046,15802,179247,0,0,0,0,0,33401,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,290788,49361,40406,178,181354,23140,94395,0,0,0,0,0,7100,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,701383,90171,123089,173985,347,24483,143036,0,0,0,0,0,35196,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,83788,8062,13770,21218,27978,90,70257,0,0,0,0,0,3609,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1621794,68622,159866,85214,180965,54995,502,0,0,0,0,0,21302,0,0,0],
[36729,3259,18653,12496,29009,21928,34390,17149,242143,160999,35395,1520,5234,996,815,1092,2921,388,746,382,464,442,146,129,223,212,259,234,146,103,1042,340,78,135,217,1683,0,0,0,0,0,0,0,141,7330,486,1753,158,0,42929,4504,33537],
[32821,2299,10580,5677,4887,2735,5751,11237,166254,1881384,337370,234789,38000,9648,3956,2547,6307,770,3188,705,709,847,316,247,438,340,418,317,224,154,1479,634,69,176,224,2572,0,0,0,0,0,0,0,8857,264,1440,4027,179,0,1905,3219,199963],
[6085,462,2082,1057,836,468,946,320,4367,30406,1547,12317,12292,7171,9772,3989,22159,3895,8924,2289,1620,1941,743,570,833,724,736,508,342,182,1618,701,80,233,208,2175,0,0,0,0,0,0,0,441,1451,76,9728,384,0,129,608,7701],
[6679,502,5233,5270,3685,1808,3131,999,12194,125697,6159,36836,48180,24206,14535,57216,189537,286912,703919,388000,15383,45796,120382,102316,51956,23358,18161,13725,7926,4176,44352,16624,1452,2665,4172,30445,0,0,0,0,0,0,0,2160,3244,8627,566,3171,0,560,2121,96055],
[1111,82,506,396,300,175,255,208,802,10231,333,1865,3257,2142,1029,2795,4892,2772,6997,3603,5289,27252,3374,3643,33897,9174,14629,20417,16263,29480,35085,127177,295287,59416,107241,588115,0,0,0,0,0,0,0,262,235,429,3053,265,0,79,215,10937],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,469656,71490,36074,6096,29899,3213,22786,0,0,0,0,0,265,0,0,0],
[34774,2944,13078,8292,10729,8603,17753,82367,16326,4075,5621,311,1228,382,120,216,775,89,203,152,81,110,38,30,101,85,71,71,32,19,286,92,10,22,31,561,0,0,0,0,0,0,0,40694,1813,119,529,32,0,434,438408,1536155],
[4669,260,992,459,862,784,653,10675,15182,17428,10098,760,3517,1093,473,1030,4651,599,742,498,328,411,117,136,240,230,304,299,252,140,1743,528,63,132,254,2436,0,0,0,0,0,0,0,4024,2941,693,2414,169,0,476812,210,180128],
[80919,5267,26496,15974,39265,27195,22156,49134,61093,73140,88272,8987,28544,11067,7821,20920,83471,12255,17420,18250,19520,18696,6935,6619,11900,9464,11080,14177,10165,5995,77876,24234,2223,7615,14313,178037,0,0,0,0,0,0,0,29116,169624,8077,101003,7929,0,1512925,170523,687]
];

var chord = d3.layout.chord()
    .padding(.02)
    .sortSubgroups(d3.descending)
    .matrix(matrix);

var width = 1280,
    height = 1280,
    innerRadius = Math.min(width, height) * .41,
    outerRadius = innerRadius * 1.1;

var fill = d3.scale.ordinal()
    .domain(d3.range(4))
    .range(["#000000", "#FFDD89", "#957244", "#F26223"]);

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height)
  .append("g")
    .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

svg.append("g").selectAll("path")
    .data(chord.groups)
  .enter().append("path")
    .style("fill", function(d) {
      console.log(d); 
      return fill(d.index);
       })
    .style("stroke", function(d) { return fill(d.index); })
    .attr("class",function(d){
      return "exit" + d.index;
    })
    .attr("d", d3.svg.arc().innerRadius(innerRadius).outerRadius(outerRadius))
    .on("mouseover", function(d){
      console.log("mouseover");
      var index = d.index;
      d3.selectAll(".exit" + d.index).transition().duration(250).attr("opacity",.3);
    })
    .on("mouseout", fade(1));
/*
var ticks = svg.append("g").selectAll("g")
    .data(chord.groups)
  .enter().append("g").selectAll("g")
    .data(groupTicks)
  .enter().append("g")
    .attr("transform", function(d) {
      return "rotate(" + (d.angle * 180 / Math.PI - 90) + ")"
          + "translate(" + outerRadius + ",0)";
    });

ticks.append("line")
    .attr("x1", 1)
    .attr("y1", 0)
    .attr("x2", 5)
    .attr("y2", 0)
    .style("stroke", "#000");

ticks.append("text")
    .attr("x", 8)
    .attr("dy", ".35em")
    .attr("transform", function(d) { return d.angle > Math.PI ? "rotate(180)translate(-16)" : null; })
    .style("text-anchor", function(d) { return d.angle > Math.PI ? "end" : null; })
    .text(function(d) { return d.label; });
*/

svg.append("g")
    .attr("class", "chord")
  .selectAll("path")
    .data(chord.chords)
  .enter().append("path")
      
    .attr("d", d3.svg.chord().radius(innerRadius))
    .attr("class",function(d){
      return "exit" + d.target.index;
    })
    .style("fill", function(d) { return fill(d.target.index); })
    .style("opacity", 1);

// Returns an array of tick angles and labels, given a group.
function groupTicks(d) {
  var k = (d.endAngle - d.startAngle) / d.value;
  return d3.range(0, d.value, 1000).map(function(v, i) {
    return {
      angle: v * k + d.startAngle,
      label: i % 5 ? null : v / 1000 + "k"
    };
  });
}

// Returns an event handler for fading a given chord group.
function fade(opacity) {
  return function(g, i) {
    svg.selectAll(".chord path")
        .filter(function(d) { return d.source.index != i && d.target.index != i; })
      .transition()
        .style("opacity", opacity);
  };
}

</script>
</body>
